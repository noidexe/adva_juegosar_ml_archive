{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"WELCOME_MSG"}]},{"resourceType":"PHOTO","capabilities":[{"name":"READ"},{"name":"UPLOAD"},{"name":"UPLOADTEMP"}]},{"resourceType":"FILE","capabilities":[{"name":"READ"},{"name":"CREATE"}]},{"resourceType":"MEMBER","capabilities":[{"name":"READ"}]},{"resourceType":"LINK","capabilities":[{"name":"CREATE"},{"name":"READ"}]},{"resourceType":"CALENDAR","capabilities":[{"name":"READ"}]},{"resourceType":"DATABASE","capabilities":[{"name":"READ_DATA"},{"name":"READ"},{"name":"CREATE"}]},{"resourceType":"POLL","capabilities":[{"name":"READ"},{"name":"VOTE"},{"name":"CREATE"}]},{"resourceType":"MESSAGE","capabilities":[{"name":"CREATE"},{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[{"name":"READ"},{"name":"UPLOAD"}]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[{"name":"READ"}]},{"resourceType":"POST","capabilities":[{"name":"READ"},{"name":"CREATE"}]},{"resourceType":"PIN","capabilities":[{"name":"DELETE"},{"name":"READ"},{"name":"UPDATE"},{"name":"CREATE"}]}],"subStatus":"NORMAL","groupUrl":"ar.groups.yahoo.com","intlCode":"ar"},"comscore":"pageview_candidate","ygData":{"userId":69924492,"authorName":"Diego Tartara","from":"Diego Tartara &lt;dtartara@...&gt;","replyTo":"LIST","senderId":"kQ516ExlLhSeRsmBuBvwQ09J_flfO9hs8ax2-yMAXqxrCkzln16ppktfynMEByuEsXm6y1llIaZzp4R2zPoP7-i7JV4wpoa27ql8uFCjSg","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [ADVA] Guardando fecha y hora en un archivo + imprimiendo  un archivo.","postDate":"1035903607","msgId":6080,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDUuMS4wLjE0LjIuMjAwMjEwMjkxMTE4NDIuMDI4MGEwMDhAcG9wLmZpYmVydGVsLmNvbS5hcj4=","inReplyToHeader":"PE9FMjhjTXpmb1YxcWRpaXhqbnowMDAwMmYxMkBob3RtYWlsLmNvbT4=","referencesHeader":"PE9FNjBRaHBUNmVmOUkwVkpQRlkwMDAwNTVkY0Bob3RtYWlsLmNvbT4gPDAwMjYwMWMyN2UzNSQ2NjljNDkwMCQxZTU2ZTgxOEBkaWVnb3BjPg=="},"prevInTopic":6069,"nextInTopic":0,"prevInTime":6079,"nextInTime":6081,"topicId":6039,"numMessagesInTopic":3,"msgSnippet":"Ignacio, Aca hay dos cosas posibles.. la primera es que la secuencia de llamados que copiaste aca esta mal. SHELLEXECUTEINFO Sei; HINSTANCE h =","rawEmail":"Return-Path: &lt;dtartara@...&gt;\r\nX-Sender: dtartara@...\r\nX-Apparently-To: JuegosAR@...\r\nReceived: (EGP: mail-8_2_2_1); 29 Oct 2002 15:04:50 -0000\r\nReceived: (qmail 31766 invoked from network); 29 Oct 2002 15:00:16 -0000\r\nReceived: from unknown (66.218.66.218)\n  by m3.grp.scd.yahoo.com with QMQP; 29 Oct 2002 15:00:16 -0000\r\nReceived: from unknown (HELO mail.fibertel.com.ar) (24.232.0.78)\n  by mta3.grp.scd.yahoo.com with SMTP; 29 Oct 2002 15:00:15 -0000\r\nReceived: from limbo.fibertel.com.ar (200.69.192.146) by mail.fibertel.com.ar (5.5.034) (authenticated as dtartara@...)\n        id 3DBE938F000034AD for JuegosAR@...; Tue, 29 Oct 2002 12:00:21 -0300\r\nMessage-Id: &lt;5.1.0.14.2.20021029111842.0280a008@...&gt;\r\nX-Sender: dtartara@...\r\nX-Mailer: QUALCOMM Windows Eudora Version 5.1\r\nDate: Tue, 29 Oct 2002 12:00:07 -0300\r\nTo: JuegosAR@...\r\nSubject: Re: [ADVA] Guardando fecha y hora en un archivo + imprimiendo\n  un archivo.\r\nIn-Reply-To: &lt;OE28cMzfoV1qdiixjnz00002f12@...&gt;\r\nReferences: &lt;OE60QhpT6ef9I0VJPFY000055dc@...&gt;\n &lt;002601c27e35$669c4900$1e56e818@diegopc&gt;\r\nMime-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;iso-8859-1&quot;; format=flowed\r\nContent-Transfer-Encoding: quoted-printable\r\nFrom: Diego Tartara &lt;dtartara@...&gt;\r\nX-Yahoo-Group-Post: member; u=69924492\r\n\r\nIgnacio,\n\nAca hay dos cosas posibles.. la primera es que la secuencia de ll=\r\namados que \ncopiaste aca esta mal.\n\n  SHELLEXECUTEINFO Sei;\n  HINSTANCE h =\r\n=3D ShellExecute(hWnd,&quot;open&quot;,&quot;imprim.txt&quot;,NULL,NULL,0);\n  ShellExecuteEx(&S=\r\nei);\n  DWORD dwError =3D GetLastError();\n\nLa llamada a ShellExecuteEx nunca=\r\n va a funcionar porque no inicializaste \nSei. Pero supongamos que no es asi=\r\n (que fue un typo).. y la llamada a \nShellExecute falla tambien.\nEn ese cas=\r\no me la juego a que ten=E9s el log abierto. Me equivoco?\nAsegurte de cerrar=\r\n el archivo antes de invocar el comando y reabrirlo \nluego. El problema es =\r\nque cuando abris un archivo con permiso de escritura \nse setea en los permi=\r\nsos 0, que es DENY ALL. Vos deber=EDas abrirlo con \nFILE_SHARE_READ, el pro=\r\nblema es que si lo hac=E9s desde fopen no hay manera.. \ntenes que usar Crea=\r\nteFile() lo cual es mezclar stdlib y API&#39;s medio feo. \nAdem=E1s este m=E9to=\r\ndo no te asegura que si la aplicaci=F3n asociada al print \npara archivos de=\r\n texto es tan dummy de abrir con permiso exclusivo (y no de \nsolo lectura) =\r\nva a fallar igualmente. Hay otro problema, que es que no \npodes saber cuand=\r\no termina el proceso (a menos que uses ShellExecuteEx() y \nhagas un wait) p=\r\nara reabrirlo.\nA mi parecer lo mejor ser=EDa, si el archivo no se vuelve ex=\r\ntremadamente \ngrande, que generes una copia en el TEMP, y mandes a escribir=\r\n esa copia.\nAa te va un codigo no probado que tal vez te sirva. Fijate que =\r\nlo hice \nrecien y seguro tiene errores.\nSaludos\nDiego\n\nBOOL PrintFile( FILE=\r\n* fp )\n{\n     bool res =3D false;\n\n     char szTempFile[MAX_PATH];\n     str=\r\ncpy(szTempFile, &quot;toprinter.tmp&quot;);\n\n     /* Tratamos de reutilizar siempre e=\r\nl mismo temp */\n     FILE* ftemp =3D fopen( szTempFile, &quot;w&quot; );\n\n     if ( f=\r\ntemp =3D=3D NULL )\n     {\n         /* Fallo, probablemente haya un print pr=\r\nevio en ejecucion\n            y el archivo este lockeado. Generamos un arch=\r\nivo unico\n         */\n         strcat( mktemp( strcpy( szTempFile, &quot;toprnXX=\r\nXX&quot; ) ), &quot;.tmp&quot; );\n         ftemp =3D fopen( szTempFile, &quot;w&quot; );\n     }\n\n   =\r\n  if ( ftemp !=3D NULL )\n     {\n         /* fp debe permiso de lectura y po=\r\nsicionamiento */\n         long pos =3D ftell(fp);\n\n         fflush(fp);\n   =\r\n      fseek(fp, 0, SEEK_SET);\n\n         char buffer[1024];\n         size_t =\r\ncount =3D fread(buffer, 1, sizeof(buffer), fp);\n\n         while ( count )\n =\r\n        {\n             fwrite( buffer, 1, count, ftemp );\n\n             if =\r\n( count =3D=3D sizeof(buffer) )\n                 count =3D fread(buffer, 1,=\r\n sizeof(buffer), fp);\n             else\n                 count =3D 0;\n     =\r\n    }\n\n         /* Cerrar temp file */\n         fclose( ftemp );\n\n         =\r\n/* Reposicionar fp */\n         fseek( fp, pos, SEEK_SET );\n\n         HINSTA=\r\nNCE h =3D \nShellExecute(GetDesktopWindow(),&quot;print&quot;,szTempFile,NULL,NULL,SW_=\r\nHIDE);\n\n         if ( (UINT) h &gt; 32 )\n             res =3D true;\n     }\n\n  =\r\n   return res;\n}\n\n\n\n\nAt 11:22 PM 10/28/2002 -0300, you wrote:\n&gt;Diego:\n&gt;\n&gt;Ef=\r\nectivamente vos sos la persona que estaba m=E1s despierta que yo. \n&gt;rBoiler=\r\n.GetLastTemperature() devuelve un double, as=ED que ya cambi=E9 el \n&gt;especi=\r\nficador a %f y todo funciona b=E1rbaro. Mil gracias por tomarte la \n&gt;molest=\r\nia de mirar el c=F3digo. Un tema menos.\n&gt;\n&gt;Estuve probando con ShellExecute=\r\n(). La aplicaci=F3n compila, pero no puedo \n&gt;hacer que abra un archivo (ya =\r\nque primero quiero probar eso, si logro \n&gt;hacerlo despu=E9s pruebo de impri=\r\nmirlo). Utilic=E9 el siguiente c=F3digo:\n&gt;\n&gt;  SHELLEXECUTEINFO Sei;\n&gt;  HINS=\r\nTANCE h =3D ShellExecute(hWnd,&quot;open&quot;,&quot;imprim.txt&quot;,NULL,NULL,0);\n&gt;  ShellExe=\r\ncuteEx(&Sei);\n&gt;  DWORD dwError =3D GetLastError();\n&gt;&quot;imprim.txt&quot; est=E1 en =\r\nel mismo directorio que el workspace. hWnd tiene un \n&gt;valor v=E1lido. GetLa=\r\nstError() devuelve el c=F3digo 5 en dwError que es:\n&gt;\n&gt;5 - Acces is denied =\r\n- ERROR_ACESS_DENIED\n&gt;\n&gt;=BFTen=E9s idea qu=E9 puede estar originando este a=\r\ncceso denegado? Desde ya, mil \n&gt;gracias por ayudarme, ya mismo te estoy agr=\r\negando en la parte de \n&gt;agradecimientos del programa.\n&gt;\n&gt;Te mando un saludo=\r\n,\n&gt;\n&gt;--Ignacio Liverotti\n&gt;&lt;mailto:iliverotti@...&gt;iliverotti@hotmail=\r\n.com\n&gt;\n&gt;----- Original Message -----\n&gt;From: &lt;mailto:dtartara@....a=\r\nr&gt;Diego T=E1rtara\n&gt;To: &lt;mailto:JuegosAR@...&gt;JuegosAR@gruposy=\r\nahoo.com.ar\n&gt;Sent: Monday, October 28, 2002 12:52 AM\n&gt;Subject: Re: [ADVA] G=\r\nuardando fecha y hora en un archivo + imprimiendo un \n&gt;archivo.\n&gt;\n&gt;Hola,\n&gt;B=\r\nueno lo que te esta pasando es lo siguiente:\n&gt;rBoiler.GetLastTemperature() =\r\ndeber=EDa devolver un int, o long para que \n&gt;funcionase (algo de 4 bytes qu=\r\ne es lo que espera %d). Y de seguro devuelve \n&gt;otra cosa (anda a saber que.=\r\n. pero no parece ser tampoco char o short). Si \n&gt;es asi asegurate de castea=\r\nr el resultado asi pushea los 4 bytes que %d espera.\n&gt;   fprintf((*lplpRegi=\r\nsterFile),&quot;Temperatura: %d Hora: %s  Fecha: %s&#92;n&quot;, \n&gt; (int) rBoiler.GetLast=\r\nTemperature(),szTime,szDate);\n&gt;\n&gt;Eso deber=EDa solucionarlo.\n&gt;En cuanto a S=\r\nhellExecute() esta declarada en &lt;ShellApi.h&gt; y tenes que \n&gt;linkear con user=\r\n32.lib.\n&gt;\n&gt;#define WIN32_LEAN_AND_MEAN\n&gt;#include &lt;windows.h&gt;\n&gt;#include &lt;she=\r\nllapi.h&gt;\n&gt;#pragma comment (lib, &quot;user32.lib&quot;)\n&gt;\n&gt;Eso deber=EDa solucionar t=\r\nu 2do problema. Otra forma de imprimir un archivo \n&gt;de texto es con CreateP=\r\nrocess y tir=E1ndole la linea del command &quot;type \n&gt;archivo.txt &gt; prn&quot;, pero =\r\ntu soluci=F3n es preferible.\n&gt;Saludos,\n&gt;Cuervo\n&gt;\n&gt;----- Original Message --=\r\n---\n&gt;From: &lt;mailto:iliverotti@...&gt;Ignacio Liverotti\n&gt;To: &lt;mailto:Ju=\r\negosAR@...&gt;Lista ADVA\n&gt;Sent: Sunday, October 27, 2002 3:11 P=\r\nM\n&gt;Subject: [ADVA] Guardando fecha y hora en un archivo + imprimiendo un ar=\r\nchivo.\n&gt;\n&gt;Hola a todos,\n&gt;\n&gt;Tengo que agregar un m=F3dulo muy simple al prog=\r\nrama para que constantemente \n&gt;vaya generando un archivo de texto con la me=\r\ndici=F3n, la hora y la fecha. \n&gt;Les mando el c=F3digo y la salida a ver si =\r\nalguno que est=E1 un poco m=E1s \n&gt;despierto que yo me puede decir en qu=E9 =\r\nla estoy pifiando.\n&gt;\n&gt;\n&gt;\n&gt;// Supongan que estoy en una funci=F3n a la cual =\r\nle pas=E9 la direcci=F3n de un \n&gt;puntero a FILE (&lpFile), el cual es v=E1l=\r\nido, y que, dentro de la funci=F3n, \n&gt;se llama lplpRegisterFile.\n&gt;\n&gt;   stat=\r\nic int cont =3D 0;\n&gt;   char szDate[9];\n&gt;   char szTime[9];\n&gt;   _strtime(szT=\r\nime); _strdate(szDate);\n&gt;   fprintf((*lplpRegisterFile),&quot;Temperatura: %d Ho=\r\nra: %s  Fecha: %s&#92;n&quot;,\n&gt;    rBoiler.GetLastTemperature(),szTime,szDate);\n&gt;\n&gt;=\r\nLa salida es:\n&gt;\n&gt;Temperatura: 0 Hora: (null)  Fecha: 14:53:11\n&gt;\n&gt;Por lo que=\r\n no entiendo qu=E9 est=E1 pasando. Creo que estoy usando bien \n&gt;fprintf. Ad=\r\nem=E1s no entiendo por qu=E9 bajo el r=F3tulo de fecha est=E1 saliendo \n&gt;la=\r\n hora, si, te=F3ricamente, le estoy pasando el string correcto de fecha. \n&gt;=\r\nBueno, en fin, al que se le ocurra que me avise, ya que perd=ED como dos \n&gt;=\r\nhoras y me falta terminar un mont=F3n de cosas m=E1s para el mi=E9rcoles.\n&gt;=\r\n\n&gt;Segunda cuesti=F3n. Necesito que cuando el usuario de la aplicaci=F3n as=\r\n=ED lo \n&gt;indique se imprima una copia del archivo. Estuve buscando durante =\r\nun buen \n&gt;rato en la MSDN y lo que m=E1s se asemeja a lo que busco es la fu=\r\nnci=F3n \n&gt;ShellExecute. El tema es: insert=E9 una llamada en el programa pa=\r\nra ver si \n&gt;por lo menos compilaba\n&gt;\n&gt;ShellExecute(hWnd,&quot;print&quot;,&quot;&quot;registro.=\r\ntxt&quot;,NULL,NULL,NULL);\n&gt;\n&gt;pero el compilador no la reconoce (MSVC++ 6). Si a=\r\nlguno tiene alguna \n&gt;experiencia con esta funci=F3n y me puede tirar alguna=\r\n idea sobre qu=E9 \n&gt;archivos #incluir , si tengo que insertar alguna librer=\r\n=EDa o algo as=ED o, \n&gt;incluso, si sabe alg=FAn otro m=E9todo para enviar u=\r\nn archivo de texto a la \n&gt;impresora desde una aplicaci=F3n a pantalla compl=\r\neta en directx (librer=EDa \n&gt;third-party, tutorial, paper, lo que sea) no d=\r\nude en enviar un mensaje.\n&gt;\n&gt;Les mando un saludo a todos,\n&gt;\n&gt;--Ignacio Live=\r\nrotti\n&gt;&lt;mailto:iliverotti@...&gt;iliverotti@...\n&gt;\n&gt;ADVA - Asoc=\r\niaci=F3n de Desarrolladores de Videojuegos Argentina.\n&gt;\n&gt;www.adva.com.ar\n&gt;-=\r\n------------------------------------------------------.\n&gt;\n&gt;\n&gt;\n&gt;Tu uso de Ya=\r\nhoo! Grupos est=E1 sujeto a las \n&gt;&lt;http://ar.docs.yahoo.com/info/utos.html&gt;=\r\nCondiciones del servicio de Yahoo!.\n&gt;\n&gt;\n&gt;ADVA - Asociaci=F3n de Desarrollad=\r\nores de Videojuegos Argentina.\n&gt;\n&gt;www.adva.com.ar\n&gt;------------------------=\r\n-------------------------------.\n&gt;\n&gt;\n&gt;\n&gt;Tu uso de Yahoo! Grupos est=E1 suje=\r\nto a las \n&gt;&lt;http://ar.docs.yahoo.com/info/utos.html&gt;Condiciones del servici=\r\no de Yahoo!.\n&gt;\n&gt;\n&gt;ADVA - Asociaci=F3n de Desarrolladores de Videojuegos Arg=\r\nentina.\n&gt;\n&gt;www.adva.com.ar\n&gt;-----------------------------------------------=\r\n--------.\n&gt;\n&gt;\n&gt;\n&gt;Tu uso de Yahoo! Grupos est=E1 sujeto a las \n&gt;&lt;http://ar.d=\r\nocs.yahoo.com/info/utos.html&gt;Condiciones del servicio de Yahoo!.\n\n\n\n"}}