{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"WELCOME_MSG"}]},{"resourceType":"PHOTO","capabilities":[{"name":"READ"},{"name":"UPLOAD"},{"name":"UPLOADTEMP"}]},{"resourceType":"FILE","capabilities":[{"name":"READ"},{"name":"CREATE"}]},{"resourceType":"MEMBER","capabilities":[{"name":"READ"}]},{"resourceType":"LINK","capabilities":[{"name":"CREATE"},{"name":"READ"}]},{"resourceType":"CALENDAR","capabilities":[{"name":"READ"}]},{"resourceType":"DATABASE","capabilities":[{"name":"READ"},{"name":"READ_DATA"},{"name":"CREATE"}]},{"resourceType":"POLL","capabilities":[{"name":"READ"},{"name":"VOTE"},{"name":"CREATE"}]},{"resourceType":"MESSAGE","capabilities":[{"name":"CREATE"},{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[{"name":"READ"},{"name":"UPLOAD"}]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[{"name":"READ"}]},{"resourceType":"POST","capabilities":[{"name":"READ"},{"name":"CREATE"}]},{"resourceType":"PIN","capabilities":[{"name":"DELETE"},{"name":"UPDATE"},{"name":"READ"},{"name":"CREATE"}]}],"subStatus":"NORMAL","groupUrl":"ar.groups.yahoo.com","intlCode":"ar"},"comscore":"pageview_candidate","ygData":{"userId":105128512,"authorName":"Ignacio Liverotti","from":"&quot;Ignacio Liverotti&quot; &lt;iliverotti@...&gt;","replyTo":"LIST","senderId":"Nn26u0RpaOJiajUpdBFhYfMswZGruyAvcFX8mkJ8a2EbeBfDnYBzK3xSZhXWSk2Kvo2LESJc5xkrAy9nHsvteaRHTxGKFfNPizFzgGglD_Lq9xA","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [ADVA] Guardando fecha y hora en un archivo + imprimiendo  un archivo.","postDate":"1035941161","msgId":6103,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PE9FMzBScXA4MEgzSFkxdWZnOVowMDAwMDkwZkBob3RtYWlsLmNvbT4=","referencesHeader":"PE9FNjBRaHBUNmVmOUkwVkpQRlkwMDAwNTVkY0Bob3RtYWlsLmNvbT4gPDAwMjYwMWMyN2UzNSQ2NjljNDkwMCQxZTU2ZTgxOEBkaWVnb3BjPiA8NS4xLjAuMTQuMi4yMDAyMTAyOTExMTg0Mi4wMjgwYTAwOEBwb3AuZmliZXJ0ZWwuY29tLmFyPg=="},"prevInTopic":0,"nextInTopic":0,"prevInTime":6102,"nextInTime":6104,"topicId":6103,"numMessagesInTopic":1,"msgSnippet":"Diego, Ahora si anduvo. El problema no es que tenía el log abierto, sino que como último parámetro le pasaba un cero, debido a que malinterpreté las","rawEmail":"Return-Path: &lt;iliverotti@...&gt;\r\nX-Sender: iliverotti@...\r\nX-Apparently-To: JuegosAR@...\r\nReceived: (EGP: mail-8_2_2_1); 30 Oct 2002 03:59:48 -0000\r\nReceived: (qmail 8267 invoked from network); 30 Oct 2002 03:59:48 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m14.grp.scd.yahoo.com with QMQP; 30 Oct 2002 03:59:48 -0000\r\nReceived: from unknown (HELO hotmail.com) (64.4.16.87)\n  by mta1.grp.scd.yahoo.com with SMTP; 30 Oct 2002 03:59:48 -0000\r\nReceived: from mail pickup service by hotmail.com with Microsoft SMTPSVC;\n\t Tue, 29 Oct 2002 19:59:47 -0800\r\nTo: &quot;Lista ADVA&quot; &lt;JuegosAR@...&gt;\r\nReferences: &lt;OE60QhpT6ef9I0VJPFY000055dc@...&gt; &lt;002601c27e35$669c4900$1e56e818@diegopc&gt; &lt;5.1.0.14.2.20021029111842.0280a008@...&gt;\r\nSubject: Re: [ADVA] Guardando fecha y hora en un archivo + imprimiendo  un archivo.\r\nDate: Tue, 29 Oct 2002 22:26:01 -0300\r\nMIME-Version: 1.0\r\nContent-Type: multipart/alternative;\n\tboundary=&quot;----=_NextPart_000_0019_01C27F9A.298A0F00&quot;\r\nX-Priority: 3\r\nX-MSMail-Priority: Normal\r\nX-Mailer: Microsoft Outlook Express 5.50.4133.2400\r\nX-MimeOLE: Produced By Microsoft MimeOLE V5.50.4133.2400\r\nMessage-ID: &lt;OE30Rqp80H3HY1ufg9Z0000090f@...&gt;\r\nX-OriginalArrivalTime: 30 Oct 2002 03:59:47.0949 (UTC) FILETIME=[CA07C9D0:01C27FC8]\r\nFrom: &quot;Ignacio Liverotti&quot; &lt;iliverotti@...&gt;\r\nX-Yahoo-Group-Post: member; u=105128512\r\n\r\n\r\n------=_NextPart_000_0019_01C27F9A.298A0F00\r\nContent-Type: text/plain;\n\tcharset=&quot;iso-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nDiego,\n\nAhora si anduvo. El problema no es que ten=EDa el log abierto, sino=\r\n que como =FAltimo par=E1metro le pasaba un cero, debido a que malinterpret=\r\n=E9 las instrucciones de la MSDN: \n\nIf lpFile specifies a document file, nS=\r\nhowCmd should be zero\n\nPienso que con &quot;document file&quot; se debe estar refirie=\r\nndo a un archivo de extensi=F3n &quot;.doc&quot; con formato de documento en vez de t=\r\nexto plano. Prob=E9 pasarle SW_MAXIMIZE e imprimi=F3 sin ning=FAn problema =\r\npor la impresora seteada por defecto. Te agradezco tambi=E9n la funci=F3n q=\r\nue escribiste, gracias a ella aprend=ED la funci=F3n &quot;mktemp&quot; que ni siquie=\r\nra sab=EDa que exist=EDa (o que hubiera una funci=F3n que realizara algo as=\r\n=ED).\n\nPor cierto, =BFd=F3nde aprendiste a usar las funciones del shell? =\r\n=BFHay alg=FAn libro que trate sobre este tema?\n\nGracias nuevamente por tod=\r\no, te mando un saludo,\n\n--Ignacio Liverotti\niliverotti@...\n  ----- =\r\nOriginal Message ----- \n  From: Diego Tartara \n  To: JuegosAR@gruposyahoo.c=\r\nom.ar \n  Sent: Tuesday, October 29, 2002 12:00 PM\n  Subject: Re: [ADVA] Gua=\r\nrdando fecha y hora en un archivo + imprimiendo un archivo.\n\n\n  Ignacio,\n\n =\r\n Aca hay dos cosas posibles.. la primera es que la secuencia de llamados qu=\r\ne \n  copiaste aca esta mal.\n\n    SHELLEXECUTEINFO Sei;\n    HINSTANCE h =3D =\r\nShellExecute(hWnd,&quot;open&quot;,&quot;imprim.txt&quot;,NULL,NULL,0);\n    ShellExecuteEx(&Sei=\r\n);\n    DWORD dwError =3D GetLastError();\n\n  La llamada a ShellExecuteEx nun=\r\nca va a funcionar porque no inicializaste \n  Sei. Pero supongamos que no es=\r\n asi (que fue un typo).. y la llamada a \n  ShellExecute falla tambien.\n  En=\r\n ese caso me la juego a que ten=E9s el log abierto. Me equivoco?\n  Asegurte=\r\n de cerrar el archivo antes de invocar el comando y reabrirlo \n  luego. El =\r\nproblema es que cuando abris un archivo con permiso de escritura \n  se sete=\r\na en los permisos 0, que es DENY ALL. Vos deber=EDas abrirlo con \n  FILE_SH=\r\nARE_READ, el problema es que si lo hac=E9s desde fopen no hay manera.. \n  t=\r\nenes que usar CreateFile() lo cual es mezclar stdlib y API&#39;s medio feo. \n  =\r\nAdem=E1s este m=E9todo no te asegura que si la aplicaci=F3n asociada al pri=\r\nnt \n  para archivos de texto es tan dummy de abrir con permiso exclusivo (y=\r\n no de \n  solo lectura) va a fallar igualmente. Hay otro problema, que es q=\r\nue no \n  podes saber cuando termina el proceso (a menos que uses ShellExecu=\r\nteEx() y \n  hagas un wait) para reabrirlo.\n  A mi parecer lo mejor ser=EDa,=\r\n si el archivo no se vuelve extremadamente \n  grande, que generes una copia=\r\n en el TEMP, y mandes a escribir esa copia.\n  Aa te va un codigo no probado=\r\n que tal vez te sirva. Fijate que lo hice \n  recien y seguro tiene errores.=\r\n\n  Saludos\n  Diego\n\n  BOOL PrintFile( FILE* fp )\n  {\n       bool res =3D fa=\r\nlse;\n\n       char szTempFile[MAX_PATH];\n       strcpy(szTempFile, &quot;toprinte=\r\nr.tmp&quot;);\n\n       /* Tratamos de reutilizar siempre el mismo temp */\n       =\r\nFILE* ftemp =3D fopen( szTempFile, &quot;w&quot; );\n\n       if ( ftemp =3D=3D NULL )\n=\r\n       {\n           /* Fallo, probablemente haya un print previo en ejecuci=\r\non\n              y el archivo este lockeado. Generamos un archivo unico\n   =\r\n        */\n           strcat( mktemp( strcpy( szTempFile, &quot;toprnXXXX&quot; ) ), =\r\n&quot;.tmp&quot; );\n           ftemp =3D fopen( szTempFile, &quot;w&quot; );\n       }\n\n       i=\r\nf ( ftemp !=3D NULL )\n       {\n           /* fp debe permiso de lectura y p=\r\nosicionamiento */\n           long pos =3D ftell(fp);\n\n           fflush(fp)=\r\n;\n           fseek(fp, 0, SEEK_SET);\n\n           char buffer[1024];\n       =\r\n    size_t count =3D fread(buffer, 1, sizeof(buffer), fp);\n\n           whil=\r\ne ( count )\n           {\n               fwrite( buffer, 1, count, ftemp );\n=\r\n\n               if ( count =3D=3D sizeof(buffer) )\n                   count=\r\n =3D fread(buffer, 1, sizeof(buffer), fp);\n               else\n            =\r\n       count =3D 0;\n           }\n\n           /* Cerrar temp file */\n       =\r\n    fclose( ftemp );\n\n           /* Reposicionar fp */\n           fseek( fp=\r\n, pos, SEEK_SET );\n\n           HINSTANCE h =3D \n  ShellExecute(GetDesktopWi=\r\nndow(),&quot;print&quot;,szTempFile,NULL,NULL,SW_HIDE);\n\n           if ( (UINT) h &gt; 3=\r\n2 )\n               res =3D true;\n       }\n\n       return res;\n  }\n\n\n\n\n  At =\r\n11:22 PM 10/28/2002 -0300, you wrote:\n  &gt;Diego:\n  &gt;\n  &gt;Efectivamente vos so=\r\ns la persona que estaba m=E1s despierta que yo. \n  &gt;rBoiler.GetLastTemperat=\r\nure() devuelve un double, as=ED que ya cambi=E9 el \n  &gt;especificador a %f y=\r\n todo funciona b=E1rbaro. Mil gracias por tomarte la \n  &gt;molestia de mirar =\r\nel c=F3digo. Un tema menos.\n  &gt;\n  &gt;Estuve probando con ShellExecute(). La a=\r\nplicaci=F3n compila, pero no puedo \n  &gt;hacer que abra un archivo (ya que pr=\r\nimero quiero probar eso, si logro \n  &gt;hacerlo despu=E9s pruebo de imprimirl=\r\no). Utilic=E9 el siguiente c=F3digo:\n  &gt;\n  &gt;  SHELLEXECUTEINFO Sei;\n  &gt;  HI=\r\nNSTANCE h =3D ShellExecute(hWnd,&quot;open&quot;,&quot;imprim.txt&quot;,NULL,NULL,0);\n  &gt;  Shel=\r\nlExecuteEx(&Sei);\n  &gt;  DWORD dwError =3D GetLastError();\n  &gt;&quot;imprim.txt&quot; es=\r\nt=E1 en el mismo directorio que el workspace. hWnd tiene un \n  &gt;valor v=E1l=\r\nido. GetLastError() devuelve el c=F3digo 5 en dwError que es:\n  &gt;\n  &gt;5 - Ac=\r\nces is denied - ERROR_ACESS_DENIED\n  &gt;\n  &gt;=BFTen=E9s idea qu=E9 puede estar=\r\n originando este acceso denegado? Desde ya, mil \n  &gt;gracias por ayudarme, y=\r\na mismo te estoy agregando en la parte de \n  &gt;agradecimientos del programa.=\r\n\n  &gt;\n  &gt;Te mando un saludo,\n  &gt;\n  &gt;--Ignacio Liverotti\n  &gt;&lt;mailto:iliverott=\r\ni@...&gt;iliverotti@...\n  &gt;\n  &gt;----- Original Message -----\n  =\r\n&gt;From: &lt;mailto:dtartara@...&gt;Diego T=E1rtara\n  &gt;To: &lt;mailto:Jueg=\r\nosAR@...&gt;JuegosAR@...\n  &gt;Sent: Monday, Octobe=\r\nr 28, 2002 12:52 AM\n  &gt;Subject: Re: [ADVA] Guardando fecha y hora en un arc=\r\nhivo + imprimiendo un \n  &gt;archivo.\n  &gt;\n  &gt;Hola,\n  &gt;Bueno lo que te esta pas=\r\nando es lo siguiente:\n  &gt;rBoiler.GetLastTemperature() deber=EDa devolver un=\r\n int, o long para que \n  &gt;funcionase (algo de 4 bytes que es lo que espera =\r\n%d). Y de seguro devuelve \n  &gt;otra cosa (anda a saber que.. pero no parece =\r\nser tampoco char o short). Si \n  &gt;es asi asegurate de castear el resultado =\r\nasi pushea los 4 bytes que %d espera.\n  &gt;   fprintf((*lplpRegisterFile),&quot;Te=\r\nmperatura: %d Hora: %s  Fecha: %s&#92;n&quot;, \n  &gt; (int) rBoiler.GetLastTemperature=\r\n(),szTime,szDate);\n  &gt;\n  &gt;Eso deber=EDa solucionarlo.\n  &gt;En cuanto a ShellE=\r\nxecute() esta declarada en &lt;ShellApi.h&gt; y tenes que \n  &gt;linkear con user32.=\r\nlib.\n  &gt;\n  &gt;#define WIN32_LEAN_AND_MEAN\n  &gt;#include &lt;windows.h&gt;\n  &gt;#include=\r\n &lt;shellapi.h&gt;\n  &gt;#pragma comment (lib, &quot;user32.lib&quot;)\n  &gt;\n  &gt;Eso deber=EDa s=\r\nolucionar tu 2do problema. Otra forma de imprimir un archivo \n  &gt;de texto e=\r\ns con CreateProcess y tir=E1ndole la linea del command &quot;type \n  &gt;archivo.tx=\r\nt &gt; prn&quot;, pero tu soluci=F3n es preferible.\n  &gt;Saludos,\n  &gt;Cuervo\n  &gt;\n  &gt;--=\r\n--- Original Message -----\n  &gt;From: &lt;mailto:iliverotti@...&gt;Ignacio =\r\nLiverotti\n  &gt;To: &lt;mailto:JuegosAR@...&gt;Lista ADVA\n  &gt;Sent: Su=\r\nnday, October 27, 2002 3:11 PM\n  &gt;Subject: [ADVA] Guardando fecha y hora en=\r\n un archivo + imprimiendo un archivo.\n  &gt;\n  &gt;Hola a todos,\n  &gt;\n  &gt;Tengo que=\r\n agregar un m=F3dulo muy simple al programa para que constantemente \n  &gt;vay=\r\na generando un archivo de texto con la medici=F3n, la hora y la fecha. \n  &gt;=\r\nLes mando el c=F3digo y la salida a ver si alguno que est=E1 un poco m=E1s =\r\n\n  &gt;despierto que yo me puede decir en qu=E9 la estoy pifiando.\n  &gt;\n  &gt;\n  &gt;=\r\n\n  &gt;// Supongan que estoy en una funci=F3n a la cual le pas=E9 la direcci=\r\n=F3n de un \n  &gt;puntero a FILE (&lpFile), el cual es v=E1lido, y que, dentro=\r\n de la funci=F3n, \n  &gt;se llama lplpRegisterFile.\n  &gt;\n  &gt;   static int cont =\r\n=3D 0;\n  &gt;   char szDate[9];\n  &gt;   char szTime[9];\n  &gt;   _strtime(szTime); =\r\n_strdate(szDate);\n  &gt;   fprintf((*lplpRegisterFile),&quot;Temperatura: %d Hora: =\r\n%s  Fecha: %s&#92;n&quot;,\n  &gt;    rBoiler.GetLastTemperature(),szTime,szDate);\n  &gt;\n =\r\n &gt;La salida es:\n  &gt;\n  &gt;Temperatura: 0 Hora: (null)  Fecha: 14:53:11\n  &gt;\n  &gt;=\r\nPor lo que no entiendo qu=E9 est=E1 pasando. Creo que estoy usando bien \n  =\r\n&gt;fprintf. Adem=E1s no entiendo por qu=E9 bajo el r=F3tulo de fecha est=E1 s=\r\naliendo \n  &gt;la hora, si, te=F3ricamente, le estoy pasando el string correct=\r\no de fecha. \n  &gt;Bueno, en fin, al que se le ocurra que me avise, ya que per=\r\nd=ED como dos \n  &gt;horas y me falta terminar un mont=F3n de cosas m=E1s para=\r\n el mi=E9rcoles.\n  &gt;\n  &gt;Segunda cuesti=F3n. Necesito que cuando el usuario =\r\nde la aplicaci=F3n as=ED lo \n  &gt;indique se imprima una copia del archivo. E=\r\nstuve buscando durante un buen \n  &gt;rato en la MSDN y lo que m=E1s se asemej=\r\na a lo que busco es la funci=F3n \n  &gt;ShellExecute. El tema es: insert=E9 un=\r\na llamada en el programa para ver si \n  &gt;por lo menos compilaba\n  &gt;\n  &gt;Shel=\r\nlExecute(hWnd,&quot;print&quot;,&quot;&quot;registro.txt&quot;,NULL,NULL,NULL);\n  &gt;\n  &gt;pero el compi=\r\nlador no la reconoce (MSVC++ 6). Si alguno tiene alguna \n  &gt;experiencia con=\r\n esta funci=F3n y me puede tirar alguna idea sobre qu=E9 \n  &gt;archivos #incl=\r\nuir , si tengo que insertar alguna librer=EDa o algo as=ED o, \n  &gt;incluso, =\r\nsi sabe alg=FAn otro m=E9todo para enviar un archivo de texto a la \n  &gt;impr=\r\nesora desde una aplicaci=F3n a pantalla completa en directx (librer=EDa \n  =\r\n&gt;third-party, tutorial, paper, lo que sea) no dude en enviar un mensaje.\n  =\r\n&gt;\n  &gt;Les mando un saludo a todos,\n  &gt;\n  &gt;--Ignacio Liverotti\n  &gt;&lt;mailto:ili=\r\nverotti@...&gt;iliverotti@...\n  &gt;\n  &gt;ADVA - Asociaci=F3n de De=\r\nsarrolladores de Videojuegos Argentina.\n  &gt;\n  &gt;www.adva.com.ar\n  &gt;---------=\r\n----------------------------------------------.\n  &gt;\n  &gt;\n  &gt;\n  &gt;Tu uso de Ya=\r\nhoo! Grupos est=E1 sujeto a las \n  &gt;&lt;http://ar.docs.yahoo.com/info/utos.htm=\r\nl&gt;Condiciones del servicio de Yahoo!.\n  &gt;\n  &gt;\n  &gt;ADVA - Asociaci=F3n de Des=\r\narrolladores de Videojuegos Argentina.\n  &gt;\n  &gt;www.adva.com.ar\n  &gt;----------=\r\n---------------------------------------------.\n  &gt;\n  &gt;\n  &gt;\n  &gt;Tu uso de Yah=\r\noo! Grupos est=E1 sujeto a las \n  &gt;&lt;http://ar.docs.yahoo.com/info/utos.html=\r\n&gt;Condiciones del servicio de Yahoo!.\n  &gt;\n  &gt;\n  &gt;ADVA - Asociaci=F3n de Desa=\r\nrrolladores de Videojuegos Argentina.\n  &gt;\n  &gt;www.adva.com.ar\n  &gt;-----------=\r\n--------------------------------------------.\n  &gt;\n  &gt;\n  &gt;\n  &gt;Tu uso de Yaho=\r\no! Grupos est=E1 sujeto a las \n  &gt;&lt;http://ar.docs.yahoo.com/info/utos.html&gt;=\r\nCondiciones del servicio de Yahoo!.\n\n\n\n  ADVA - Asociaci=F3n de Desarrollad=\r\nores de Videojuegos Argentina.\n\n  www.adva.com.ar\n  -----------------------=\r\n--------------------------------.\n\n\n\n  Tu uso de Yahoo! Grupos est=E1 sujet=\r\no a las Condiciones del servicio de Yahoo!. \n\n\r\n------=_NextPart_000_0019_01C27F9A.298A0F00\r\nContent-Type: text/html;\n\tcharset=&quot;iso-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\n&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;&gt;\n&lt;HTML&gt;&lt;HEAD&gt;=\r\n\n&lt;META http-equiv=3DContent-Type content=3D&quot;text/html; charset=3Diso-8859-1=\r\n&quot;&gt;\n&lt;META content=3D&quot;MSHTML 5.50.4134.600&quot; name=3DGENERATOR&gt;\n&lt;STYLE&gt;&lt;/STYLE&gt;=\r\n\n&lt;/HEAD&gt;\n&lt;BODY bgColor=3D#ffffff&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;Diego,&lt;/=\r\nFONT&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT=\r\n face=3DArial size=3D2&gt;Ahora si anduvo. El problema no es que ten=EDa el lo=\r\ng \nabierto, sino que como =FAltimo par=E1metro le pasaba un cero, debido a =\r\nque \nmalinterpret=E9 las instrucciones de la MSDN: &lt;/FONT&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT=\r\n face=3DArial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2=\r\n&gt;&lt;FONT face=3D&quot;Times New Roman&quot; size=3D3&gt;If \n&lt;I&gt;lpFile&lt;/I&gt; specifies a docu=\r\nment file, &lt;I&gt;nShowCmd&lt;/I&gt; should be \nzero&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT f=\r\nace=3DArial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;P=\r\nienso que con &quot;document file&quot; se debe estar \nrefiriendo a un archivo de ext=\r\nensi=F3n &quot;.doc&quot; con formato de documento en vez de \ntexto plano. Prob=E9 pa=\r\nsarle SW_MAXIMIZE e imprimi=F3 sin ning=FAn problema por la \nimpresora sete=\r\nada por defecto. Te agradezco&nbsp;tambi=E9n la funci=F3n que \nescribiste, =\r\ngracias a ella aprend=ED la funci=F3n &quot;mktemp&quot; que ni siquiera sab=EDa que =\r\n\nexist=EDa (o que hubiera una funci=F3n que realizara algo as=ED).&lt;/FONT&gt;&lt;/=\r\nDIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=\r\n=3DArial size=3D2&gt;Por cierto, =BFd=F3nde aprendiste a usar las funciones \nd=\r\nel shell? =BFHay alg=FAn libro que trate&nbsp;sobre este&nbsp;tema?&lt;/FONT&gt;&lt;=\r\n/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=\r\n=3DArial size=3D2&gt;Gracias nuevamente por todo, te mando un \nsaludo,&lt;/FONT&gt;&lt;=\r\n/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=\r\n=3DArial size=3D2&gt;--Ignacio Liverotti&lt;/FONT&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial =\r\nsize=3D2&gt;&lt;A \nhref=3D&quot;mailto:iliverotti@...&quot;&gt;iliverotti@...&lt;=\r\n/A&gt;&lt;/FONT&gt;&lt;/DIV&gt;\n&lt;BLOCKQUOTE \nstyle=3D&quot;PADDING-RIGHT: 0px; PADDING-LEFT: 5p=\r\nx; MARGIN-LEFT: 5px; BORDER-LEFT: #000000 2px solid; MARGIN-RIGHT: 0px&quot;&gt;\n  =\r\n&lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;----- Original Message ----- &lt;/DIV&gt;\n  &lt;DIV =\r\n\n  style=3D&quot;BACKGROUND: #e4e4e4; FONT: 10pt arial; font-color: black&quot;&gt;&lt;B&gt;Fr=\r\nom:&lt;/B&gt; \n  &lt;A title=3Ddtartara@... href=3D&quot;mailto:dtartara@fibe=\r\nrtel.com.ar&quot;&gt;Diego \n  Tartara&lt;/A&gt; &lt;/DIV&gt;\n  &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;=\r\n&lt;B&gt;To:&lt;/B&gt; &lt;A title=3DJuegosAR@... \n  href=3D&quot;mailto:JuegosA=\r\nR@...&quot;&gt;JuegosAR@...&lt;/A&gt; \n  &lt;/DIV&gt;\n  &lt;DIV styl=\r\ne=3D&quot;FONT: 10pt arial&quot;&gt;&lt;B&gt;Sent:&lt;/B&gt; Tuesday, October 29, 2002 12:00 \n  PM&lt;/=\r\nDIV&gt;\n  &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;&lt;B&gt;Subject:&lt;/B&gt; Re: [ADVA] Guardando=\r\n fecha y \n  hora en un archivo + imprimiendo un archivo.&lt;/DIV&gt;\n  &lt;DIV&gt;&lt;BR&gt;&lt;=\r\n/DIV&gt;&lt;TT&gt;Ignacio,&lt;BR&gt;&lt;BR&gt;Aca hay dos cosas posibles.. la primera es \n  que =\r\nla secuencia de llamados que &lt;BR&gt;copiaste aca esta mal.&lt;BR&gt;&lt;BR&gt;&nbsp; \n  SH=\r\nELLEXECUTEINFO Sei;&lt;BR&gt;&nbsp; HINSTANCE h =3D \n  ShellExecute(hWnd,&quot;open&quot;,&quot;=\r\nimprim.txt&quot;,NULL,NULL,0);&lt;BR&gt;&nbsp; \n  ShellExecuteEx(&amp;Sei);&lt;BR&gt;&nbsp; =\r\nDWORD dwError =3D GetLastError();&lt;BR&gt;&lt;BR&gt;La \n  llamada a ShellExecuteEx nun=\r\nca va a funcionar porque no inicializaste &lt;BR&gt;Sei. \n  Pero supongamos que n=\r\no es asi (que fue un typo).. y la llamada a \n  &lt;BR&gt;ShellExecute falla tambi=\r\nen.&lt;BR&gt;En ese caso me la juego a que ten=E9s el log \n  abierto. Me equivoco=\r\n?&lt;BR&gt;Asegurte de cerrar el archivo antes de invocar el \n  comando y reabrir=\r\nlo &lt;BR&gt;luego. El problema es que cuando abris un archivo con \n  permiso de =\r\nescritura &lt;BR&gt;se setea en los permisos 0, que es DENY ALL. Vos \n  deber=EDa=\r\ns abrirlo con &lt;BR&gt;FILE_SHARE_READ, el problema es que si lo hac=E9s desde \n=\r\n  fopen no hay manera.. &lt;BR&gt;tenes que usar CreateFile() lo cual es mezclar =\r\n\n  stdlib y API&#39;s medio feo. &lt;BR&gt;Adem=E1s este m=E9todo no te asegura que s=\r\ni la \n  aplicaci=F3n asociada al print &lt;BR&gt;para archivos de texto es tan du=\r\nmmy de abrir \n  con permiso exclusivo (y no de &lt;BR&gt;solo lectura) va a falla=\r\nr igualmente. Hay \n  otro problema, que es que no &lt;BR&gt;podes saber cuando te=\r\nrmina el proceso (a \n  menos que uses ShellExecuteEx() y &lt;BR&gt;hagas un wait)=\r\n para reabrirlo.&lt;BR&gt;A mi \n  parecer lo mejor ser=EDa, si el archivo no se v=\r\nuelve extremadamente &lt;BR&gt;grande, \n  que generes una copia en el TEMP, y man=\r\ndes a escribir esa copia.&lt;BR&gt;Aa te va \n  un codigo no probado que tal vez t=\r\ne sirva. Fijate que lo hice &lt;BR&gt;recien y \n  seguro tiene errores.&lt;BR&gt;Saludo=\r\ns&lt;BR&gt;Diego&lt;BR&gt;&lt;BR&gt;BOOL PrintFile( FILE* fp \n  )&lt;BR&gt;{&lt;BR&gt;&nbsp;&nbsp;&nbsp;&=\r\nnbsp; bool res =3D \n  false;&lt;BR&gt;&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp; char \n  szTemp=\r\nFile[MAX_PATH];&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp; strcpy(szTempFile, \n  &quot;toprinte=\r\nr.tmp&quot;);&lt;BR&gt;&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp; /* Tratamos de reutilizar \n  siemp=\r\nre el mismo temp */&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp; FILE* ftemp =3D fopen( \n  s=\r\nzTempFile, &quot;w&quot; );&lt;BR&gt;&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp; if ( ftemp =3D=3D NULL \n =\r\n )&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp; \n  {&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=\r\n&nbsp;&nbsp; /* Fallo, probablemente \n  haya un print previo en \n  ejecucio=\r\nn&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n  =\r\ny el archivo este lockeado. Generamos un archivo \n  unico&lt;BR&gt;&nbsp;&nbsp;&n=\r\nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n  */&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=\r\nnbsp;&nbsp;&nbsp; strcat( mktemp( strcpy( \n  szTempFile, &quot;toprnXXXX&quot; ) ), &quot;=\r\n.tmp&quot; \n  );&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ftemp =3D f=\r\nopen( \n  szTempFile, &quot;w&quot; );&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp; \n  }&lt;BR&gt;&lt;BR&gt;&nbsp;&=\r\nnbsp;&nbsp;&nbsp; if ( ftemp !=3D NULL \n  )&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp; \n  =\r\n{&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* fp debe permiso de=\r\n \n  lectura y posicionamiento \n  */&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=\r\n&nbsp;&nbsp; long pos =3D \n  ftell(fp);&lt;BR&gt;&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=\r\np;&nbsp;&nbsp;&nbsp; \n  fflush(fp);&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=\r\n&nbsp;&nbsp; fseek(fp, 0, \n  SEEK_SET);&lt;BR&gt;&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=\r\np;&nbsp;&nbsp;&nbsp; char \n  buffer[1024];&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=\r\n;&nbsp;&nbsp;&nbsp; size_t count \n  =3D fread(buffer, 1, sizeof(buffer), \n =\r\n fp);&lt;BR&gt;&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while ( count=\r\n \n  )&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n  {&lt;BR&gt;&nbsp;&nb=\r\nsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n  fwrite( =\r\nbuffer, 1, count, ftemp \n  );&lt;BR&gt;&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=\r\nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n  if ( count =3D=3D sizeof(buffer) \n  )=\r\n&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=\r\n;&nbsp;&nbsp;&nbsp;&nbsp; \n  count =3D fread(buffer, 1, sizeof(buffer), \n  =\r\nfp);&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=\r\nnbsp; \n  else&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=\r\np;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n  count =3D 0;&lt;BR&gt;&nbsp;&nbsp;&nbsp=\r\n;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n  }&lt;BR&gt;&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=\r\nnbsp;&nbsp;&nbsp; /* Cerrar temp file \n  */&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=\r\np;&nbsp;&nbsp;&nbsp; fclose( ftemp \n  );&lt;BR&gt;&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nb=\r\nsp;&nbsp;&nbsp;&nbsp; /* Reposicionar fp \n  */&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&=\r\nnbsp;&nbsp;&nbsp;&nbsp; fseek( fp, pos, \n  SEEK_SET );&lt;BR&gt;&lt;BR&gt;&nbsp;&nbsp;&=\r\nnbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HINSTANCE \n  h =3D \n  &lt;BR&gt;ShellExecute(=\r\nGetDesktopWindow(),&quot;print&quot;,szTempFile,NULL,NULL,SW_HIDE);&lt;BR&gt;&lt;BR&gt;&nbsp;&nbs=\r\np;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n  if ( (UINT) h &gt; 32 \n  )&lt;BR&gt;&nb=\r\nsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n  re=\r\ns =3D true;&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp; }&lt;BR&gt;&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp; \n=\r\n  return res;&lt;BR&gt;}&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;At 11:22 PM 10/28/2002 -0300, you \n  =\r\nwrote:&lt;BR&gt;&gt;Diego:&lt;BR&gt;&gt;&lt;BR&gt;&gt;Efectivamente vos sos la persona que \n =\r\n estaba m=E1s despierta que yo. &lt;BR&gt;&gt;rBoiler.GetLastTemperature() devuel=\r\nve un \n  double, as=ED que ya cambi=E9 el &lt;BR&gt;&gt;especificador a %f y todo=\r\n funciona \n  b=E1rbaro. Mil gracias por tomarte la &lt;BR&gt;&gt;molestia de mira=\r\nr el c=F3digo. Un \n  tema menos.&lt;BR&gt;&gt;&lt;BR&gt;&gt;Estuve probando con ShellEx=\r\necute(). La aplicaci=F3n \n  compila, pero no puedo &lt;BR&gt;&gt;hacer que abra u=\r\nn archivo (ya que primero \n  quiero probar eso, si logro &lt;BR&gt;&gt;hacerlo de=\r\nspu=E9s pruebo de imprimirlo). \n  Utilic=E9 el siguiente c=F3digo:&lt;BR&gt;&gt;&lt;=\r\nBR&gt;&gt;&nbsp; SHELLEXECUTEINFO \n  Sei;&lt;BR&gt;&gt;&nbsp; HINSTANCE h =3D \n  She=\r\nllExecute(hWnd,&quot;open&quot;,&quot;imprim.txt&quot;,NULL,NULL,0);&lt;BR&gt;&gt;&nbsp; \n  ShellExec=\r\nuteEx(&amp;Sei);&lt;BR&gt;&gt;&nbsp; DWORD dwError =3D \n  GetLastError();&lt;BR&gt;&gt;=\r\n&quot;imprim.txt&quot; est=E1 en el mismo directorio que el \n  workspace. hWnd tiene =\r\nun &lt;BR&gt;&gt;valor v=E1lido. GetLastError() devuelve el \n  c=F3digo 5 en dwEr=\r\nror que es:&lt;BR&gt;&gt;&lt;BR&gt;&gt;5 - Acces is denied - \n  ERROR_ACESS_DENIED&lt;BR&gt;&=\r\ngt;&lt;BR&gt;&gt;=BFTen=E9s idea qu=E9 puede estar originando este \n  acceso dene=\r\ngado? Desde ya, mil &lt;BR&gt;&gt;gracias por ayudarme, ya mismo te estoy \n  agre=\r\ngando en la parte de &lt;BR&gt;&gt;agradecimientos del \n  programa.&lt;BR&gt;&gt;&lt;BR&gt;&g=\r\nt;Te mando un saludo,&lt;BR&gt;&gt;&lt;BR&gt;&gt;--Ignacio \n  Liverotti&lt;BR&gt;&gt;&lt;mail=\r\nto:iliverotti@...&gt;iliverotti@...&lt;BR&gt;&gt;&lt;BR&gt;&gt;----- \n =\r\n Original Message -----&lt;BR&gt;&gt;From: \n  &lt;mailto:dtartara@...=\r\n&gt;Diego T=E1rtara&lt;BR&gt;&gt;To: \n  &lt;mailto:JuegosAR@...&gt=\r\n;JuegosAR@...&lt;BR&gt;&gt;Sent: \n  Monday, October 28, 2002 12:52=\r\n AM&lt;BR&gt;&gt;Subject: Re: [ADVA] Guardando fecha y \n  hora en un archivo + im=\r\nprimiendo un \n  &lt;BR&gt;&gt;archivo.&lt;BR&gt;&gt;&lt;BR&gt;&gt;Hola,&lt;BR&gt;&gt;Bueno lo que t=\r\ne esta pasando es \n  lo siguiente:&lt;BR&gt;&gt;rBoiler.GetLastTemperature() debe=\r\nr=EDa devolver un int, o \n  long para que &lt;BR&gt;&gt;funcionase (algo de 4 byt=\r\nes que es lo que espera %d). Y \n  de seguro devuelve &lt;BR&gt;&gt;otra cosa (and=\r\na a saber que.. pero no parece ser \n  tampoco char o short). Si &lt;BR&gt;&gt;es =\r\nasi asegurate de castear el resultado asi \n  pushea los 4 bytes que %d espe=\r\nra.&lt;BR&gt;&gt;&nbsp;&nbsp; \n  fprintf((*lplpRegisterFile),&quot;Temperatura: %d Hor=\r\na: %s&nbsp; Fecha: %s&#92;n&quot;, \n  &lt;BR&gt;&gt; (int) rBoiler.GetLastTemperature(),sz=\r\nTime,szDate);&lt;BR&gt;&gt;&lt;BR&gt;&gt;Eso \n  deber=EDa solucionarlo.&lt;BR&gt;&gt;En cuant=\r\no a ShellExecute() esta declarada en \n  &lt;ShellApi.h&gt; y tenes que &lt;BR&gt;=\r\n&gt;linkear con \n  user32.lib.&lt;BR&gt;&gt;&lt;BR&gt;&gt;#define WIN32_LEAN_AND_MEAN&lt;B=\r\nR&gt;&gt;#include \n  &lt;windows.h&gt;&lt;BR&gt;&gt;#include &lt;shellapi.h&gt;&lt;BR&gt;&=\r\ngt;#pragma comment \n  (lib, &quot;user32.lib&quot;)&lt;BR&gt;&gt;&lt;BR&gt;&gt;Eso deber=EDa solu=\r\ncionar tu 2do problema. \n  Otra forma de imprimir un archivo &lt;BR&gt;&gt;de tex=\r\nto es con CreateProcess y \n  tir=E1ndole la linea del command &quot;type &lt;BR&gt;&gt=\r\n;archivo.txt &gt; prn&quot;, pero tu \n  soluci=F3n es preferible.&lt;BR&gt;&gt;Saludos=\r\n,&lt;BR&gt;&gt;Cuervo&lt;BR&gt;&gt;&lt;BR&gt;&gt;----- \n  Original Message -----&lt;BR&gt;&gt;From:=\r\n \n  &lt;mailto:iliverotti@...&gt;Ignacio Liverotti&lt;BR&gt;&gt;To: \n  &l=\r\nt;mailto:JuegosAR@...&gt;Lista ADVA&lt;BR&gt;&gt;Sent: Sunday, \n  =\r\nOctober 27, 2002 3:11 PM&lt;BR&gt;&gt;Subject: [ADVA] Guardando fecha y hora en u=\r\nn \n  archivo + imprimiendo un archivo.&lt;BR&gt;&gt;&lt;BR&gt;&gt;Hola a \n  todos,&lt;BR&gt;&=\r\ngt;&lt;BR&gt;&gt;Tengo que agregar un m=F3dulo muy simple al programa para \n  que=\r\n constantemente &lt;BR&gt;&gt;vaya generando un archivo de texto con la medici=F3=\r\nn, \n  la hora y la fecha. &lt;BR&gt;&gt;Les mando el c=F3digo y la salida a ver s=\r\ni alguno \n  que est=E1 un poco m=E1s &lt;BR&gt;&gt;despierto que yo me puede deci=\r\nr en qu=E9 la estoy \n  pifiando.&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt;// Supongan=\r\n que estoy en una funci=F3n \n  a la cual le pas=E9 la direcci=F3n de un &lt;BR=\r\n&gt;&gt;puntero a FILE (&amp;lpFile), el \n  cual es v=E1lido, y que, dentro de=\r\n la funci=F3n, &lt;BR&gt;&gt;se llama \n  lplpRegisterFile.&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;&=\r\nnbsp; static int cont =3D \n  0;&lt;BR&gt;&gt;&nbsp;&nbsp; char szDate[9];&lt;BR&gt;&gt;=\r\n&nbsp;&nbsp; char \n  szTime[9];&lt;BR&gt;&gt;&nbsp;&nbsp; _strtime(szTime); \n  _s=\r\ntrdate(szDate);&lt;BR&gt;&gt;&nbsp;&nbsp; \n  fprintf((*lplpRegisterFile),&quot;Tempera=\r\ntura: %d Hora: %s&nbsp; Fecha: \n  %s&#92;n&quot;,&lt;BR&gt;&gt;&nbsp;&nbsp;&nbsp; \n  rBoil=\r\ner.GetLastTemperature(),szTime,szDate);&lt;BR&gt;&gt;&lt;BR&gt;&gt;La salida \n  es:&lt;BR&gt;=\r\n&gt;&lt;BR&gt;&gt;Temperatura: 0 Hora: (null)&nbsp; Fecha: \n  14:53:11&lt;BR&gt;&gt;&lt;BR=\r\n&gt;&gt;Por lo que no entiendo qu=E9 est=E1 pasando. Creo que \n  estoy usando =\r\nbien &lt;BR&gt;&gt;fprintf. Adem=E1s no entiendo por qu=E9 bajo el r=F3tulo \n  de=\r\n fecha est=E1 saliendo &lt;BR&gt;&gt;la hora, si, te=F3ricamente, le estoy pasand=\r\no el \n  string correcto de fecha. &lt;BR&gt;&gt;Bueno, en fin, al que se le ocurr=\r\na que me \n  avise, ya que perd=ED como dos &lt;BR&gt;&gt;horas y me falta termina=\r\nr un mont=F3n de \n  cosas m=E1s para el mi=E9rcoles.&lt;BR&gt;&gt;&lt;BR&gt;&gt;Segunda=\r\n cuesti=F3n. Necesito que \n  cuando el usuario de la aplicaci=F3n as=ED lo =\r\n&lt;BR&gt;&gt;indique se imprima una copia \n  del archivo. Estuve buscando durant=\r\ne un buen &lt;BR&gt;&gt;rato en la MSDN y lo que \n  m=E1s se asemeja a lo que bus=\r\nco es la funci=F3n &lt;BR&gt;&gt;ShellExecute. El tema es: \n  insert=E9 una llama=\r\nda en el programa para ver si &lt;BR&gt;&gt;por lo menos \n  compilaba&lt;BR&gt;&gt;&lt;BR&gt;=\r\n&gt;ShellExecute(hWnd,&quot;print&quot;,&quot;&quot;registro.txt&quot;,NULL,NULL,NULL);&lt;BR&gt;&gt;&lt;BR&gt;&=\r\ngt;pero \n  el compilador no la reconoce (MSVC++ 6). Si alguno tiene alguna =\r\n\n  &lt;BR&gt;&gt;experiencia con esta funci=F3n y me puede tirar alguna idea sobr=\r\ne qu=E9 \n  &lt;BR&gt;&gt;archivos #incluir , si tengo que insertar alguna librer=\r\n=EDa o algo as=ED \n  o, &lt;BR&gt;&gt;incluso, si sabe alg=FAn otro m=E9todo para=\r\n enviar un archivo de texto \n  a la &lt;BR&gt;&gt;impresora desde una aplicaci=F3=\r\nn a pantalla completa en directx \n  (librer=EDa &lt;BR&gt;&gt;third-party, tutori=\r\nal, paper, lo que sea) no dude en enviar \n  un mensaje.&lt;BR&gt;&gt;&lt;BR&gt;&gt;Les =\r\nmando un saludo a \n  todos,&lt;BR&gt;&gt;&lt;BR&gt;&gt;--Ignacio \n  Liverotti&lt;BR&gt;&gt;&l=\r\nt;mailto:iliverotti@...&gt;iliverotti@...&lt;BR&gt;&gt;&lt;BR&gt;&gt;AD=\r\nVA \n  - Asociaci=F3n de Desarrolladores de Videojuegos \n  Argentina.&lt;BR&gt;&gt=\r\n;&lt;BR&gt;&gt;www.adva.com.ar&lt;BR&gt;&gt;-------------------------------------------=\r\n------------.&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt;Tu \n  uso de Yahoo! Grupos est=\r\n=E1 sujeto a las &lt;BR&gt;&gt;&lt;&lt;A \n  href=3D&quot;http://ar.docs.yahoo.com/info/ut=\r\nos.html&quot;&gt;http://ar.docs.yahoo.com/info/utos.html&lt;/A&gt;&gt;Condiciones \n  del =\r\nservicio de Yahoo!.&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt;ADVA - Asociaci=F3n de \n  Desarr=\r\nolladores de Videojuegos \n  Argentina.&lt;BR&gt;&gt;&lt;BR&gt;&gt;www.adva.com.ar&lt;BR&gt;&g=\r\nt;-------------------------------------------------------.&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;=\r\nBR&gt;&gt;&lt;BR&gt;&gt;Tu \n  uso de Yahoo! Grupos est=E1 sujeto a las &lt;BR&gt;&gt;&lt;&lt;=\r\nA \n  href=3D&quot;http://ar.docs.yahoo.com/info/utos.html&quot;&gt;http://ar.docs.yahoo.=\r\ncom/info/utos.html&lt;/A&gt;&gt;Condiciones \n  del servicio de Yahoo!.&lt;BR&gt;&gt;&lt;BR=\r\n&gt;&gt;&lt;BR&gt;&gt;ADVA - Asociaci=F3n de \n  Desarrolladores de Videojuegos \n  Ar=\r\ngentina.&lt;BR&gt;&gt;&lt;BR&gt;&gt;www.adva.com.ar&lt;BR&gt;&gt;----------------------------=\r\n---------------------------.&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt;Tu \n  uso de Ya=\r\nhoo! Grupos est=E1 sujeto a las &lt;BR&gt;&gt;&lt;&lt;A \n  href=3D&quot;http://ar.docs.ya=\r\nhoo.com/info/utos.html&quot;&gt;http://ar.docs.yahoo.com/info/utos.html&lt;/A&gt;&gt;Cond=\r\niciones \n  del servicio de Yahoo!.&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;/TT&gt;&lt;BR&gt;&lt;TT&gt;ADVA - Asociaci=\r\n=F3n de \n  Desarrolladores de Videojuegos \n  Argentina.&lt;BR&gt;&lt;BR&gt;www.adva.com=\r\n.ar&lt;BR&gt;-------------------------------------------------------.&lt;BR&gt;&lt;BR&gt;&lt;/TT=\r\n&gt;&lt;BR&gt;&lt;BR&gt;&lt;TT&gt;Tu \n  uso de Yahoo! Grupos est=E1 sujeto a las &lt;A \n  href=3D&quot;h=\r\nttp://ar.docs.yahoo.com/info/utos.html&quot;&gt;Condiciones del servicio de \n  Yaho=\r\no!&lt;/A&gt;.&lt;/TT&gt; &lt;BR&gt;&lt;/BLOCKQUOTE&gt;&lt;/BODY&gt;&lt;/HTML&gt;\n\r\n------=_NextPart_000_0019_01C27F9A.298A0F00--\r\n\n"}}